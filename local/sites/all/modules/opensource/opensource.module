<?php

/**
 * Implementation of hook_form_alter
 */
function opensource_form_alter(&$form, &$form_state, $form_id) {
 // If we have a lead image, we know we should include an /imce upload link
 if($form['field_lead_image']) {
  $form['imce_link'] = array(
    '#type' => 'markup',
    '#weight' => -10,
    '#value' => l("Upload Images", "imce", array('attributes' => array('target' => '_blank'))),
  );
 }
}

/**
 * Implementation of hook_block
 */
function opensource_block($op = 'list', $delta = 0, $edit = array()) {
  switch($op) {
    case "list":
      $blocks = array();
      $blocks['foobar'] = array('info' => 'Dummy Block');
      $blocks['opensource-social-links'] = array(
        'info' => 'opensource: Social Links',
      );
      return $blocks;
    case "view":
      if($delta == 'opensource-social-links'){
        $block = array(
          'subject' => '<none>',
          'content' => opensource_display_social_block(),
        );
      }
      return $block;
  }
}

function opensource_display_social_block() {
  $links = array();
  $links['twitter'] = array(
    'href' => 'http://twitter.com/opensourceway',
    'title' => theme_image('sites/all/themes/sitetheme/images/twitter.jpg'),
    'html' => TRUE,
  );
  $links['facebook'] = array(
    'href' => 'http://facebook.com/pages/opensourcecom/162962298056',
    'title' => theme_image('sites/all/themes/sitetheme/images/facebook.jpg'),
    'html' => TRUE,
  );
  $links['identica'] = array(
    'href' => 'http://identi.ca/opensourceway',
    'title' => theme_image('sites/all/themes/sitetheme/images/identica.png'),
    'html' => TRUE,
  );
  $links['flickr'] = array(
    'href' => 'http://www.flickr.com/photos/opensourceway',
    'title' => theme_image('sites/all/themes/sitetheme/images/flickr_24x24.jpg'),
    'html' => TRUE,
  );
  $links['youtube'] = array(
    'href' => 'http://www.youtube.com/opensourceway',
    'title' => theme_image('sites/all/themes/sitetheme/images/youtube.jpg'),
    'html' => TRUE,
  );
  $links['rss'] = array(
    'href' => 'http://www.youtube.com/opensourceway',
    'title' => theme_image('sites/all/themes/sitetheme/images/osdc_rss_24x24.png'),
    'html' => TRUE,
  );
  
  $output = theme_links($links, array('class' => 'social-links'));
  $output .= l(theme_image('sites/all/themes/sitetheme/images/email-signup.png'), 'https://engage.redhat.com/forms/opensourcedotcom-subscription',
               array('html' => TRUE, 'attributes' => array('class' => 'newsletter')));
  return $output;
}